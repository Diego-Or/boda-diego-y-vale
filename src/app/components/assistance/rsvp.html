<!-- src/app/components/rsvp/rsvp.component.html -->
<section id="rsvp">
  <h2 class="section-title">Confirma tu Asistencia</h2>
  <p class="section-subtitle">
    Por favor confirma antes del {{ formattedDeadline() }}
  </p>

  @if (isDeadlinePassed()) {
    <div class="deadline-alert">
      <p>‚ö†Ô∏è La fecha l√≠mite para confirmaciones ha pasado. Si necesitas confirmar tu asistencia, por favor cont√°ctanos directamente.</p>
    </div>
  }

  <form [formGroup]="rsvpForm" (ngSubmit)="onSubmit()" class="rsvp-form">

    <!-- Nombre completo -->
    <div class="form-group">
      <label for="nombre">Nombre completo *</label>
      <input
        type="text"
        id="nombre"
        formControlName="nombre"
        placeholder="Ingresa tu nombre completo"
        [class.error]="nombre?.invalid && nombre?.touched">
      @if (nombre?.invalid && nombre?.touched) {
        <span class="error-text">
          @if (nombre?.errors?.['required']) {
            El nombre es obligatorio
          }
          @if (nombre?.errors?.['minlength']) {
            El nombre debe tener al menos 3 caracteres
          }
        </span>
      }
    </div>

    <!-- N√∫mero de celular -->
    <div class="form-group">
      <label for="celular">N√∫mero de celular *</label>
      <input
        type="tel"
        id="celular"
        formControlName="celular"
        placeholder="3001234567 (10 d√≠gitos)"
        maxlength="10"
        (input)="formatearCelular($event)"
        [class.error]="celular?.invalid && celular?.touched">
      @if (celular?.invalid && celular?.touched) {
        <span class="error-text">
          @if (celular?.errors?.['required']) {
            El n√∫mero de celular es obligatorio
          }
          @if (celular?.errors?.['pattern'] || celular?.errors?.['minlength']) {
            El celular debe tener exactamente 10 d√≠gitos
          }
        </span>
      }
      <small class="helper-text">Ingresa solo n√∫meros, sin espacios ni guiones</small>
    </div>

    <!-- Mensaje de error general -->
    @if (errorMessage()) {
      <div class="error-message">
        {{ errorMessage() }}
      </div>
    }

    <!-- Bot√≥n de env√≠o -->
    <button
      type="submit"
      class="submit-btn"
      [class.loading]="isLoading()"
      [disabled]="isLoading() || isDeadlinePassed()">
      @if (isLoading()) {
        Guardando...
      } @else {
        Confirmar Asistencia
      }
    </button>

    <!-- Bot√≥n de descarga -->
    <!-- <button
      type="button"
      class="submit-btn secondary-btn"
      (click)="descargarExcel()">
      üìä Descargar Lista de Confirmaciones ({{ confirmacionesCount() }})
    </button> -->

    <!-- Mensaje de √©xito -->
    @if (showSuccessMessage()) {
      <div class="success-message">
        ¬°Gracias por confirmar! Nos emociona celebrar contigo üéâ
      </div>
    }
  </form>
</section>
